<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{admin/layout/default}">
<head>
</head>

<th:block layout:fragment="customContent">
  <section class="content-main">
    <form id="addMedicine" th:action="@{/admin/member/memberInsert}" method="post">
      <div class="row">
        <div class="col-6">
          <div class="content-header">
            <h2 class="content-title" th:text="${content}">새로운 회원 등록</h2>
            <div>
              <button id="resetBtn" class="btn btn-light rounded font-sm mr-5 text-body hover-up">등록 취소</button>
              <input type="button" id="submitBtn" class="btn btn-md rounded font-sm hover-up" value="회원 등록" />
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-6">
          <div class="card mb-4">
            <div class="card-body">
              <div class="row">
                <div class="col-md-3">
                  <h6>1. 회원정보입력</h6>
                </div>
                <div class="col-md-9">
                  <div class="mb-4">
                    <label class="form-label" for="mId">회원아이디</label>
                    <input type="text" placeholder="아이디를 입력해주세요" name="mId" id="mId" class="form-control" >
                  </div>
                  <div class="mb-4">
                    <label class="form-label" for="mPw">회원비밀번호</label>
                    <input type="text" placeholder="비밀번호를 입력해주세요." name="mPw" id="mPw" class="form-control" >
                  </div>
                  <div class="mb-4">
                    <label class="form-label" for="level">약사등급선택</label>
                    <select class="form-select" name="level" id="level">
                      <option>약사등급 선택</option>
                      <option value="1">1.개국약사</option>
                      <option value="2">2.관리약사</option>
                    </select>
                  </div>
                  <div class="mb-4">
                    <label class="form-label" for="Name">회원이름</label>
                    <input type="text" placeholder="이름을 입력해주세요" name="Name"  id="Name" class="form-control">
                  </div>
                  <div class="mb-4">
                    <label class="form-label" for="Email">이메일</label>
                    <input type="text" placeholder="이메일을 입력해주세요" name="Email"  id="Email" class="form-control">
                  </div>
                  <div class="mb-4">
                    <label class="form-label mr-30" >성별</label>
                    <input class="mr-5"type="radio" name="Gender"/>남
                    <input class="ml-5 mr-5"type="radio" name="Gender"/>여
                  </div>
                </div> <!-- col.// -->
              </div> <!-- row.// -->
              <hr class="mb-4 mt-0">
              <div class="row">
                <div class="col-md-3">
                  <h6>2. 의약품 판매 정보</h6>
                </div>
                <div class="col-md-9">
                  <div class="mb-4">
                    <label class="form-label" for="mediDetail">의약품 상세 설명</label>
                    <textarea placeholder="의약품에 관한 설명을 적어주세요" name="mediDetail" id="mediDetail" class="form-control" rows="4"></textarea>
                  </div>
                  <div class="mb-4">
                    <label for="mediPrice" class="form-label">판매 가격</label>
                    <sub class="float-end">단위 : 원</sub>
                    <input type="text" name="mediPrice" id="mediPrice" class="form-control">
                  </div>
                  <div class="mb-4">
                    <label for="regQty" class="form-label">판매 수량</label>
                    <sub class="float-end">단위 : 개</sub>
                    <input type="text" name="regQty" id="regQty" class="form-control">
                  </div>
                </div> <!-- col.// -->
              </div> <!-- row.// -->
              <hr class="mb-4 mt-0">
              <div class="row">
                <div class="col-md-3">
                  <h6>3. 이미지 파일</h6>
                </div>
                <div class="col-md-9">
                  <div class="mb-4">
                    <label for="mediImg" class="form-label">의약품 이미지</label>
                    <input name="mediImg" id="mediImg" class="form-control" type="file">
                  </div>
                </div> <!-- col.// -->
              </div> <!-- .row end// -->
            </div>
          </div>
        </div>
      </div>
    </form>
  </section> <!-- content-main end// -->

</th:block>

<th:block layout:fragment="customJsFile">
</th:block>

<th:block layout:fragment="customJs">
  <script th:inline="javascript">
    $('#resetBtn').click(e => {
      e.preventDefault();
      location.href = '/admin/adminMain';
    });

    $('#submitBtn').click(function(){
      let isSubmit = true;
      $('#addMedicine input, #addMedicine select').each((idx, element) => {
        const id = element.id;
        const value = element.value;
        if(!value){
          alert(`${id}는(은) 필수 입력 항목입니다`);
          $(element.focus());
          isSubmit = false;
          return false;
        }
      });
      if(isSubmit) $('#addMedicine').submit();
    });

    const createIngrRow = () => {
      const ingrContent = [
        { 'tagName' : 'input', 'type' : 'text', 'name' : 'Ingredient' },
        { 'tagName' : 'input', 'type' : 'text', 'name' : 'content' },
        { 'tagName' : 'button', 'type' : 'button' }
      ];
      const $tr = $('<tr></tr>');
      ingrContent.forEach(item => {
        const $td = $('<td></td>');
        const tagName = item.tagName;
        delete item.tagName;
        const $element = $('<' + tagName + ' />', item);
        $td.append($element);
        $tr.append($td);
      });
      return $tr;
    }
    // 3. 행의 추가 버튼
    $(document).on('click', '.ingrAddBtn', function(){
      $('#ingrTbody button:last').addClass('ingrDelBtn')
              .removeClass('ingrAddBtn')
              .text('삭제');
      const $row = createIngrRow();
      $row.find('input').addClass('form-control');
      $row.find('button').addClass('btn btn-md rounded font-sm hover-up ingrAddBtn')
              .text('추가');
      $('#ingrTbody').append($row);
    });
    // 4. 행의 삭제 버튼
    $(document).on('click', '.ingrDelBtn', function(){
      $(this).closest('tr').remove();
    });

    const createEffiRow = () => {
      const ingrContent = [
        { 'tagName' : 'input', 'type' : 'text', 'name' : 'efficacy' },
        { 'tagName' : 'button', 'type' : 'button' }
      ];
      const $tr = $('<tr></tr>');
      ingrContent.forEach(item => {
        const $td = $('<td></td>');
        const tagName = item.tagName;
        delete item.tagName;
        const $element = $('<' + tagName + ' />', item);
        $td.append($element);
        $tr.append($td);
      });
      return $tr;
    }
    // 3. 행의 추가 버튼
    $(document).on('click', '.effiAddBtn', function(){
      $('#effiTbody button:last').addClass('effiDelBtn')
              .removeClass('effiAddBtn')
              .text('삭제');
      const $row = createEffiRow();
      $row.find('input').addClass('form-control');
      $row.find('button').addClass('btn btn-md rounded font-sm hover-up float-end effiAddBtn')
              .text('추가');
      $('#effiTbody').append($row);
    });
    // 4. 행의 삭제 버튼
    $(document).on('click', '.effiDelBtn', function(){
      $(this).closest('tr').remove();
    });
  </script>
</th:block>
</html>